## 调试虎牙 

发现找到 pending 正在连接中 WebSocket

并发送一条测试信息

![debugger](../img/39.png)

进入js代码，发现new WebSocket

![debugger](../img/40.png)

这里就要注意，无论js代码怎么混淆 new WebSocket 肯定会出现

    s && !o.online && e.useHttps && (h += ":4434");
    var p = new WebSocket((e.useHttps ? "wss://" : "ws://") + h + _);
    p.ip = h,
    p.onopen = c,
    p.onclose = d,
    p.onerror = d
    
通过搜索发现很多 onmessage 和 send 方法

一个个打断点非常麻烦，直接hook
    
    p.send_ = p.send;
    p.send = function(t){
        debugger;
        return p.send_(t);
    }

![debugger](../img/41.png)

hook

![debugger](../img/42.png)

发送弹暮测试，定位到加密函数

![debugger](../img/43.png)

r中间存在我发送的代码内容，打上断点

    d.writeStruct("tReq", r)